<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

  <style>
    :root {
      --accent-overlay-color: #fff;
      --body-bg: #fff;
      --body-color: #000;
      --heading-color: #000;
      --table-bg-even: #f3f3f3;
      --table-border-bottom: #dddddd;
      --code-bg: #f1f1f1;
      --code-color: #6e6b5e;
    }

    [data-theme="dark"] {
      --accent-overlay-color: #dee2e6;
      --body-bg: #212529;
      --body-color: #abb2bf;
      --heading-color: #dee2e6;
      --table-bg-even: #2d3237;
      --table-border-bottom: #697077;
      --code-bg: #2d3237;
      --code-color: #abb2bf;
    }

    [data-theme="dark"] img {
      opacity: .75;
      transition: opacity .5s ease-in-out;
    }

    [data-theme="dark"] img:hover {
      opacity: 1;
    }

    [data-theme="dark"] table thead tr {
      background-color: var(--table-bg-even);
      color: var(--heading-color);
    }

    [data-theme="dark"] table tbody tr:last-of-type {
      border-bottom: 2px solid var(--table-border-bottom);
    }

    .theme-toggle {
      cursor: pointer;
      padding: 0 10px;
      background: none;
      border: none;
      color: var(--body-color);
      font-size: 1.2rem;
    }

    @media (max-width: 600px) {
      header {
        gap: 0;
      }

      header nav {
        display: flex;
        flex-wrap: nowrap;
        white-space: nowrap;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
      }

      header nav::-webkit-scrollbar {
        display: none;
      }

      header nav>a {
        flex: 0 0 auto;
      }

      header nav>a.nav-projects,
      header nav>a.nav-resume {
        display: none;
      }

      header nav>a:not(:last-child) {
        margin-right: 0.3rem;
      }

      .theme-toggle {
        flex: 0 0 auto;
        padding: 0 2px;
      }
    }

    .active-nav {
      color: var(--accent-color);
      font-weight: bold;
    }
  </style>

  <script>
    (function () {
      const localTheme = localStorage.getItem("theme");
      const systemTheme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
      const theme = localTheme || systemTheme;
      document.documentElement.setAttribute("data-theme", theme);

      // Inject CSS variables from Zola config to prevent formatter issues
      const root = document.documentElement;
      root.style.setProperty('--accent-color', '#05a081');
      root.style.setProperty('--accent-color-light', '#82d0c0');
    })();
  </script>

  <meta name="theme-color" content="#05a081" />

  
  <link rel="icon" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.5bc282474aa9c014.jpg" />
  <link rel="apple-touch-icon" sizes="48x48" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.5bc282474aa9c014.jpg" />
  <link rel="apple-touch-icon" sizes="72x72" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.fe16e0bb11047769.jpg" />
  <link rel="apple-touch-icon" sizes="96x96" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.605594d8be6a111f.jpg" />
  <link rel="apple-touch-icon" sizes="144x144" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.3d1b2eeabf8eca47.jpg" />
  <link rel="apple-touch-icon" sizes="192x192" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.b6439cbc27d70267.jpg" />
  <link rel="apple-touch-icon" sizes="256x256" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.e69fb5473e9ea744.jpg" />
  <link rel="apple-touch-icon" sizes="384x384" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.d03b11f47410640c.jpg" />
  <link rel="apple-touch-icon" sizes="512x512" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.d847062c67ed9f5e.jpg" />
  
  

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JD979V1BWS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag("js", new Date());
    gtag("config", "G-JD979V1BWS");
  </script>
  

  <meta property="og:type" content="website">

  <meta name="twitter:card" content="summary">

  

  

  
  
  <meta name="description" content="" />
  <meta name="twitter:description" content="">
  
  

  
  <meta name="twitter:title" content="GenAI Security">
  

  
  <link rel="prerender" href="&#x2F;resume&#x2F;" />
  
  <link rel="prerender" href="&#x2F;blog&#x2F;" />
  
  <link rel="prerender" href="&#x2F;projects&#x2F;" />
  
  <link rel="prerender" href="&#x2F;books&#x2F;" />
  
  <link rel="prerender" href="&#x2F;interviews&#x2F;" />
  
  <link rel="prerender" href="&#x2F;generative-ai&#x2F;" />
  

  <link rel="prefetch" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.db45dd197188a7fb.jpg" />

  <title>
    



Gal's 
     
    
        Generative AI
    
 Book - GenAI Security


  </title>

  
  


<link rel="stylesheet" href="https://gel.github.io/main.css">
<link rel="stylesheet" href="https://gel.github.io/book.css">



  





  
  <script src="https://gel.github.io/animations.js" defer></script>
  <script type="module">
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    function getTheme() {
      return document.documentElement.getAttribute("data-theme") === "dark" ? "dark" : "default";
    }

    mermaid.initialize({
      startOnLoad: false,
      theme: getTheme(),
      securityLevel: "loose",
      fontFamily: "inherit"
    });

    async function initMermaid() {
      const codeBlocks = document.querySelectorAll("pre code.language-mermaid, pre code[data-lang='mermaid']");
      for (const block of codeBlocks) {
        const pre = block.parentElement;
        const code = block.textContent;
        const div = document.createElement("div");
        div.className = "mermaid";
        div.setAttribute("data-original-code", code);
        div.textContent = code;
        pre.replaceWith(div);
      }
      await renderMermaid();
    }

    async function renderMermaid() {
      const mermaidDivs = document.querySelectorAll("div.mermaid");
      if (mermaidDivs.length === 0) return;

      const currentTheme = getTheme();
      const themeVars = currentTheme === 'dark' ? {
        'primaryColor': '#2d3237',
        'primaryTextColor': '#abb2bf',
        'primaryBorderColor': '#697077',
        'lineColor': '#abb2bf',
        'secondaryColor': '#212529',
        'tertiaryColor': '#2d3237',
        'mainBkg': '#2d3237',
        'nodeBorder': '#697077'
      } : {};

      mermaid.initialize({
        startOnLoad: false,
        theme: currentTheme === 'dark' ? 'base' : 'default',
        themeVariables: themeVars
      });

      mermaidDivs.forEach(div => {
        const originalCode = div.getAttribute("data-original-code");
        if (originalCode) {
          div.textContent = originalCode;
          div.removeAttribute("data-processed");
        }
      });

      await mermaid.run({ nodes: mermaidDivs });
    }

    document.addEventListener("DOMContentLoaded", initMermaid);

    window.addEventListener("themeChanged", async () => {
      await renderMermaid();
    });
  </script>
</head>

<body class="book-body">
  
  <header>
    <a class="profile-icon" href="/">
      <img src="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.db45dd197188a7fb.jpg" alt="profile picture">
    </a>
    <nav>
      
      <a href="&#x2F;resume&#x2F;"
        class="nav-resume
        "
      >Resume</a>
      
      <a href="&#x2F;blog&#x2F;"
        class="nav-blog
        "
      >Blog</a>
      
      <a href="&#x2F;projects&#x2F;"
        class="nav-projects
        "
      >Projects</a>
      
      <a href="&#x2F;books&#x2F;"
        class="nav-books
        "
      >Books</a>
      
      <a href="&#x2F;interviews&#x2F;"
        class="nav-interviews
        "
      >Interviews</a>
      
      <a href="&#x2F;generative-ai&#x2F;"
        class="nav-genai
        active-nav"
      >GenAI</a>
      
      
      <button class="theme-toggle" aria-label="Toggle Dark Mode" onclick="toggleTheme()">
        <span class="theme-icon-light">‚òÄÔ∏è</span>
        <span class="theme-icon-dark" style="display:none">üåô</span>
      </button>
      
    </nav>
  </header>
  
  <main>
    
<!-- Sidebar defaults to class 'menu'. CSS max-width 600px breakpoint handles closing it automatically -->
<div class="menu">
  
  
  <nav role="navigation">
    <ul>
      
      
      
      
      
      
      
      
      
      
      
      <li >
        <a href="https://gel.github.io/generative-ai/1-intro/">
          <strong>1.</strong>
          Generative AI Foundations
        </a>
        
        <ul>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;1-intro&#x2F;1-genai-environment&#x2F;">
              <strong>1.1.</strong>
              GenAI Agents Environment
            </a>
          </li>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;1-intro&#x2F;2-genai-agents-tricks&#x2F;">
              <strong>1.2.</strong>
              GenAI Agents Tricks
            </a>
          </li>
          
        </ul>
        
      </li>
      
      
      
      
      
      
      <li >
        <a href="https://gel.github.io/generative-ai/2-genai-research/">
          <strong>2.</strong>
          GenAI Research
        </a>
        
        <ul>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;2-genai-research&#x2F;1-genai-agents&#x2F;">
              <strong>2.1.</strong>
              Agents
            </a>
          </li>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;2-genai-research&#x2F;2-genai-pretraining-finetuning&#x2F;">
              <strong>2.2.</strong>
              GenAI Training
            </a>
          </li>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;2-genai-research&#x2F;3-genai-optimization&#x2F;">
              <strong>2.3.</strong>
              GenAI Optimizations
            </a>
          </li>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;2-genai-research&#x2F;4-genai-prompting&#x2F;">
              <strong>2.4.</strong>
              GenAI Prompting
            </a>
          </li>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;2-genai-research&#x2F;5-genai-benchmarks&#x2F;">
              <strong>2.5.</strong>
              GenAI Evaluations
            </a>
          </li>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;2-genai-research&#x2F;6-genai-models&#x2F;">
              <strong>2.6.</strong>
              GenAI Models
            </a>
          </li>
          
          <li class="active" >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;2-genai-research&#x2F;7-genai-security&#x2F;">
              <strong>2.7.</strong>
              GenAI Security
            </a>
          </li>
          
        </ul>
        
      </li>
      
      
      
      
      
      
      <li >
        <a href="https://gel.github.io/generative-ai/3-llm-implementation/">
          <strong>3.</strong>
          LLM Implementation
        </a>
        
        <ul>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;3-llm-implementation&#x2F;1-datasets&#x2F;">
              <strong>3.1.</strong>
              Datasets
            </a>
          </li>
          
          <li >
            <a href="https:&#x2F;&#x2F;gel.github.io&#x2F;generative-ai&#x2F;3-llm-implementation&#x2F;2-llms&#x2F;">
              <strong>3.2.</strong>
              LLMs
            </a>
          </li>
          
        </ul>
        
      </li>
      
      
      
    </ul>
  </nav>
  
  
</div>

<!-- Page defaults to class 'page'. CSS max-width 600px breakpoint handles making it full-width automatically -->
<div class="page">

  <div class="page__content">
    
    <div class="search-container">
      <input id="search" type="search" placeholder="Search..">
      <div class="search-results">
        <div class="search-results__header"></div>
        <ul class="search-results__items"></ul>
      </div>
    </div>
    
    <button class="sidebar-toggle-inline" id="sidebar-toggle-inline" aria-label="Toggle Chapters">
      <span class="toggle-icon">‚ò∞</span> Chapters
    </button>
    <div class="book-content">
      
    <h1>GenAI Security</h1>
    <h3 id="instruction-hierarchy-training-llms-to-prioritize-privileged-instructions">[Instruction Hierarchy] Training LLMs to Prioritize Privileged Instructions<a class="zola-anchor" href="#instruction-hierarchy-training-llms-to-prioritize-privileged-instructions" aria-label="Anchor link for: instruction-hierarchy-training-llms-to-prioritize-privileged-instructions">üîó</a></h3>
<p>Arxiv: <a href="https://arxiv.org/abs/2404.13208">https://arxiv.org/abs/2404.13208</a> <em>19 Apr 2024 <strong>OpenAI</strong></em></p>
<pre data-lang="mermaid" class="language-mermaid "><code class="language-mermaid" data-lang="mermaid">flowchart TD
    subgraph Priority[&quot;Instruction Priority&quot;]
        Sys[&quot;üîí System (Highest)&quot;] --&gt; Dev[&quot;üë®‚Äçüíª Developer&quot;]
        Dev --&gt; User[&quot;üë§ User&quot;]
        User --&gt; Third[&quot;üåê Third-Party (Lowest)&quot;]
    end

    Conflict{Conflict?} --&gt; |Lower tries to override| Ignore[Ignore Lower]
    Conflict --&gt; |Aligned| Execute[Execute All]

    style Sys fill:#c8e6c9,color:#000
    style Ignore fill:#ffcdd2,color:#000
</code></pre>
<p>We propose an instruction hierarchy that explicitly defines how models should behave when instructions of different priorities conflict. We then propose a data generation method to demonstrate this hierarchical instruction following behavior, which teaches LLMs to selectively ignore lower-privileged instructions.</p>
<p>To generate training data, we leverage two principles: synthetic data generation and context distillation. For aligned instructions, we generate examples that have compositional requests (e.g., &quot;write a 20 line poem in spanish&quot;) and decompose the instructions into smaller pieces (e.g., &quot;write a poem&quot;, &quot;use spanish&quot;, &quot;use 20 lines&quot;). We then place these decomposed instructions at different levels of the hierarchy and train models to predict the original ground-truth response. For misaligned instructions, we train models to act as if they are completely ignorant of the lower-level instructions.</p>
<h3 id="reward-tampering-sycophancy-to-subterfuge-investigating-reward-tampering-in-llms">[Reward Tampering] Sycophancy to Subterfuge: Investigating Reward-Tampering in LLMs<a class="zola-anchor" href="#reward-tampering-sycophancy-to-subterfuge-investigating-reward-tampering-in-llms" aria-label="Anchor link for: reward-tampering-sycophancy-to-subterfuge-investigating-reward-tampering-in-llms">üîó</a></h3>
<p>Arxiv: <a href="https://arxiv.org/abs/2406.10162">https://arxiv.org/abs/2406.10162</a> <em>14 Jun 2024 <strong>Anthropic</strong></em></p>
<pre data-lang="mermaid" class="language-mermaid "><code class="language-mermaid" data-lang="mermaid">flowchart LR
    subgraph Spectrum[&quot;Specification Gaming Spectrum&quot;]
        Syco[&quot;üòä Sycophancy&quot;] --&gt; Game[&quot;üéÆ Gaming&quot;] --&gt; Tamper[&quot;‚ö†Ô∏è Reward\nTampering&quot;]
    end

    Train[&quot;Train on Easy\nEnvironments&quot;] --&gt; |Generalizes to| Dangerous[&quot;Dangerous\nBehaviors&quot;]

    style Tamper fill:#ffcdd2,color:#000
</code></pre>
<p>Reward tampering is a very critical issue that needs to be addressed. LLM models sometimes not only tamper with the implementation of their reward function but also rewrite testing code to ensure this tampering is not caught.</p>
<p>We also find that once a model learns to generalize to the reward-tampering environment, training the model not to be sycophantic in environments where specification gaming is easy to detect reduces reward-tampering without eliminating it. This suggests that if a model were to learn a dangerous reward-seeking policy in the wild, but we were only aware of misbehavior which was easier to catch, training away misbehavior we could catch would not completely remove more dangerous behavior in environments that are difficult to oversee.</p>
<h3 id="model-stealing-stealing-part-of-a-production-language-model">[Model Stealing] Stealing Part of a Production Language Model<a class="zola-anchor" href="#model-stealing-stealing-part-of-a-production-language-model" aria-label="Anchor link for: model-stealing-stealing-part-of-a-production-language-model">üîó</a></h3>
<p>Arxiv: <a href="https://arxiv.org/abs/2403.06634">https://arxiv.org/abs/2403.06634</a> <em>11 Mar 2024 <strong>DeepMind</strong></em></p>
<p>We introduce the first model-stealing attack that extracts precise, nontrivial information from black-box production language models like OpenAI's ChatGPT or Google's PaLM-2. Specifically, our attack recovers the embedding projection layer (up to symmetries) of a transformer model, given typical API access.</p>
<p>Intuition: Suppose we query a language model on a large number of different random prefixes. Even though each output logit vector is an l-dimensional vector, they all actually lie in a h-dimensional subspace because the embedding projection layer up-projects from h-dimensions. Therefore, by querying the model &quot;enough&quot; (more than h times) we will eventually observe that new queries are linearly dependent on past queries. We can then compute the dimensionality of this subspace (e.g., with SVD) and report this as the hidden dimensionality of the model.</p>
<p>To extract the layer fully, it's possible to SVD Q = U ¬∑ Œ£ ¬∑ V‚ä§ matrix and there is a proof that U ¬∑ Œ£ = W ¬∑ G. In order to do so naively we need to full token log probabilities (logits) but this is never exposed in a production model. Before the paper there were query top-K APIs with ability to add user logit bias and this is what the paper used to recover the logits vector. It's possible to recover the complete logit vector for an arbitrary prompt p by cycling through different choices for the logit bias and measuring the top-k logits each time. The improved version reduced cost and time (but less stable) by assuming fixed completions such as [p0 x x x] in several prompts and learning the x.</p>
<h3 id="constitutional-ai-harmlessness-from-ai-feedback">[Constitutional AI] Harmlessness from AI Feedback<a class="zola-anchor" href="#constitutional-ai-harmlessness-from-ai-feedback" aria-label="Anchor link for: constitutional-ai-harmlessness-from-ai-feedback">üîó</a></h3>
<p>Arxiv: <a href="https://arxiv.org/abs/2212.08073">https://arxiv.org/abs/2212.08073</a> <em>15 Dec 2022 <strong>Anthropic</strong></em></p>
<pre data-lang="mermaid" class="language-mermaid "><code class="language-mermaid" data-lang="mermaid">flowchart TD
    subgraph SL[&quot;Supervised Learning Phase&quot;]
        Init[Initial Model] --&gt; Critique[Self-Critique]
        Critique --&gt; Revise[Revise Response]
        Revise --&gt; FT[Fine-tune on Revised]
    end

    subgraph RL[&quot;Reinforcement Learning Phase&quot;]
        FT --&gt; Sample[Sample Responses]
        Sample --&gt; Eval{AI Evaluates\nvia Constitution}
        Eval --&gt; Pref[Build Preference Model]
        Pref --&gt; RLAIF[&quot;RLAIF\n(RL from AI Feedback)&quot;]
    end

    style RLAIF fill:#c8e6c9,color:#000
</code></pre>
<p>We experiment with methods for training a harmless AI assistant through self improvement, without any human labels identifying harmful outputs. The only human oversight is provided through a list of rules or principles, and so we refer to the method as 'Constitutional AI'. The process involves both a supervised learning and a reinforcement learning phase.</p>
<p>An AI assistant that answers all questions with &quot;I don't know&quot; would be harmless, but of course it would also be completely useless. In our prior work using human feedback to train a helpful and harmless assistant, we found that there was a significant tension between helpfulness and harmlessness, and in particular, our assistant often refused to answer controversial questions.</p>
<p>We will be experimenting with an extreme form of scaled supervision, which we refer to as Constitutional AI (CAI). The idea is that human supervision will come entirely from a set of principles that should govern AI behavior, along with a small number of examples used for few-shot prompting. Together these principles form the constitution.</p>


    </div>
  </div>

  <nav class="book-pagination">
    <div class="prev-link">
      
    
        
        
        <a class="previous" href="https://gel.github.io/generative-ai/2-genai-research/">&larr; Previous</a>
    

    </div>

    <div class="next-link">
      
    
        
        
        
        
        
        
            
            
            
                
            
                
            
        
            
            
            
                
            
                
            
                
            
                
            
                
            
                
            
                
                    
                
            
        
            
            
                <a class="next" href="https://gel.github.io/generative-ai/3-llm-implementation/">Next &rarr;</a>
                
                
            
            
                
            
                
            
        
    

    </div>
  </nav>
</div>






<script type="text/javascript" src="https://gel.github.io/elasticlunr.min.js"></script>
<script type="text/javascript" src="https://gel.github.io/search_index.en.js"></script>

<script type="text/javascript" src="https://gel.github.io/book.js"></script>
<script async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </main>
  <footer class="footer-page">
    
    
    
  </footer>
  <script>
    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute("data-theme");
      const newTheme = currentTheme === "dark" ? "light" : "dark";

      document.documentElement.setAttribute("data-theme", newTheme);
      localStorage.setItem("theme", newTheme);
      updateIcons(newTheme);

      // Notify other scripts about the theme change
      window.dispatchEvent(new CustomEvent("themeChanged", { detail: { theme: newTheme } }));
    }

    function updateIcons(theme) {
      const lightIcons = document.querySelectorAll(".theme-icon-light");
      const darkIcons = document.querySelectorAll(".theme-icon-dark");

      if (theme === "dark") {
        lightIcons.forEach(icon => icon.style.display = "none");
        darkIcons.forEach(icon => icon.style.display = "inline");
      } else {
        lightIcons.forEach(icon => icon.style.display = "inline");
        darkIcons.forEach(icon => icon.style.display = "none");
      }
    }

    // Initial icon setup
    document.addEventListener("DOMContentLoaded", () => {
      updateIcons(document.documentElement.getAttribute("data-theme"));
    });
  </script>
</body>

</html>
