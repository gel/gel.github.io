<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />

    <style>
      :root {
        --accent-color: #05a081;
        --accent-color-light: #82d0c0;
        --accent-overlay-color: #fff;
        --body-bg: #fff;
        --body-color: #000;
        --heading-color: #000;
        --table-bg-even: #f3f3f3;
        --table-border-bottom: #dddddd;
      }
      
    </style>

    <meta name="theme-color" content="#05a081" />

    
      <link rel="icon" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.5bc282474aa9c014.jpg" />
      <link rel="apple-touch-icon" sizes="48x48" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.5bc282474aa9c014.jpg" />
      <link rel="apple-touch-icon" sizes="72x72" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.fe16e0bb11047769.jpg" />
      <link rel="apple-touch-icon" sizes="96x96" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.605594d8be6a111f.jpg" />
      <link rel="apple-touch-icon" sizes="144x144" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.3d1b2eeabf8eca47.jpg" />
      <link rel="apple-touch-icon" sizes="192x192" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.b6439cbc27d70267.jpg" />
      <link rel="apple-touch-icon" sizes="256x256" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.e69fb5473e9ea744.jpg" />
      <link rel="apple-touch-icon" sizes="384x384" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.d03b11f47410640c.jpg" />
      <link rel="apple-touch-icon" sizes="512x512" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.d847062c67ed9f5e.jpg" />
      
    

    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-JD979V1BWS"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JD979V1BWS');
      </script>
    

    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary">

    

    

    
      
        <meta name="description" content="" />
        <meta name="twitter:description" content="">
      
    

    
      <meta name="twitter:title" content="GenAI Real Face Superhero">
    

    
      <link rel="prerender" href="&#x2F;blog&#x2F;" />
    
      <link rel="prerender" href="&#x2F;books&#x2F;" />
    
      <link rel="prerender" href="&#x2F;interviews&#x2F;" />
    
      <link rel="prerender" href="&#x2F;generative-ai&#x2F;" />
    

    <link rel="prefetch" href="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.db45dd197188a7fb.jpg" />

    <title>
      
        
          GenAI Real Face Superhero
        
      
    </title>

    
    
      <link rel="stylesheet" href="https://gel.github.io/main.css">
    
    
  

  

  
    <link rel="prerender"  href="https://gel.github.io/tags/generative-ai/">
  
    <link rel="prerender"  href="https://gel.github.io/tags/dall-e/">
  
    <link rel="prerender"  href="https://gel.github.io/tags/chatgpt/">
  
    <link rel="prerender"  href="https://gel.github.io/tags/faceswap/">
  

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://google.com/article"
      },
      "headline": "GenAI Real Face Superhero",
      "image": [],
      "datePublished": "2024-01-16T00:00:00+00:00",
      "dateModified": "2024-01-16T00:00:00+00:00"
    }
  </script>

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        

        
        {
          
          "@type": "ListItem",
          "position": 1,
          "name": "Gal&#x27;s Pragmatic Software Blog",
          "item": "https://gel.github.io/"
        },
        
        {
          
          "@type": "ListItem",
          "position": 2,
          "name": "",
          "item": "https://gel.github.io/blog/"
        },
        
        {
          "@type": "ListItem",
          "position": 3,
          "name": "GenAI Real Face Superhero",
          "item": "https://gel.github.io/blog/dalle-faceswap/"
        }
      ]
    }
  </script>

  </head>
  <body>
    
      <header>
        <a class="profile-icon" href="/">
          <img src="https:&#x2F;&#x2F;gel.github.io&#x2F;processed_images&#x2F;iconweb.db45dd197188a7fb.jpg" alt="profile picture">
        </a>
        <nav>
          
            <a href="&#x2F;blog&#x2F;">Blog</a>
          
            <a href="&#x2F;books&#x2F;">Books</a>
          
            <a href="&#x2F;interviews&#x2F;">Interviews</a>
          
            <a href="&#x2F;generative-ai&#x2F;">Gen AI</a>
          
        </nav>
      </header>
    
    <main>
    
  <div class="post-title">
    <h1>GenAI Real Face Superhero</h1>
    <small>
      January 16, 2024
      
        - 
        <span class="tags">
          
            <a href="https://gel.github.io/tags/generative-ai/">Generative AI</a>
          
            <a href="https://gel.github.io/tags/dall-e/">Dall-E</a>
          
            <a href="https://gel.github.io/tags/chatgpt/">ChatGPT</a>
          
            <a href="https://gel.github.io/tags/faceswap/">FaceSwap</a>
          
        </span>
      
    </small>
  </div>

  <div>
    <p>Generative AI has been phenomenal in everything related to productivity given inputs such as free-text or code.
The new image or multi-modal based foundation models has made tremendous improvements and I wanted to explore them.</p>
<p>My goal was generating superheroes portraits using a ChatGPT Pro subscription (Dall-E is included).</p>
<h2 id="generating-superheroes-portraits-with-chatgpt-dall-e">Generating Superheroes Portraits with ChatGPT (Dall-E)</h2>
<p>ChatGPT (Dall-E) will let you draw abstract superheroes but it is currently not possible to generate them from real people photos.</p>
<p>The generic response Dall-E will output is: &quot;I'm sorry, but I'm unable to use real individuals' faces from images to create new images. If you have any other requests or need assistance with something else, feel free to ask!&quot; </p>
<p>Therefore, we will leverage Dall-E just to generate a generic face superhero (cartoonish or real) and later on replace it using a different product.</p>
<p>My project was generating a superhero named &quot;דני כוסברו&quot; which is a humorous word-play for a famous news broadcaster named &quot;Dani Kushmaro&quot; and Cilantro.</p>
<p>In order to generate a portrait I've uploaded the portrait of the reporter and asked ChatGPT:</p>
<p>&quot;Draw a real person face that has coriander. The person should look like a superhero&quot;</p>
<p>This is the output image I got:</p>
<img src="/blog/2024-01-16-dalle-corianderman1.png" alt="Coriander Man" width="300" />
<p>As you can see this is a great representation for a first try but the biggest problem that I've learnt later is that the coriander on the face makes it very difficult for the face-swap tool later.</p>
<p>In order to fix it, I've asked ChatGPT to fix it by writing:</p>
<p>&quot;Draw a portrait of a person with their face merged with coriander, make sure the face is not too hidden so it can be easily replaced with a real person&quot;</p>
<p>Output image came exactly as I wanted it to be:</p>
<img src="/blog/2024-01-16-dalle-corianderman2.png" alt="Coriander Man Fixed" width="300" />
<p>Let's move to the second part of replacing it with the reporter real face.</p>
<h2 id="face-swap-simple-picsi-ai">Face Swap - Simple (picsi.ai)</h2>
<p>InsightFace is an open source 2D&amp;3D deep face analysis library with more than 15k stars on github.</p>
<p>The product that is built on top of this library and more features is called picsi.ai and it is possible to set up a discord bot for free with 50 credits to leverage the face-swap functionality.</p>
<p>This is the <a href="https://github.com/deepinsight/insightface/tree/master/web-demos/swapping_discord">swapping_discord</a> github link but the process is super simple so I will describe it here.</p>
<p>Step-by-step guide:</p>
<ol>
<li>
<p>Refer to this link to register Discord app, create a new chat room, and invite the Midjourney bot to the chat room.</p>
</li>
<li>
<p>Invite the InsightFaceSwap bot to the chat room by this link: <a href="https://discord.com/api/oauth2/authorize?client_id=1090660574196674713&amp;permissions=274877945856&amp;scope=bot">Discord Invite Link</a>.</p>
</li>
<li>
<p>Use <code>/saveid</code> command to register your person id with image/features.</p>
</li>
<li>
<p>Use <code>/swapid</code> command to swap the input image with a given saved ID.</p>
</li>
</ol>
<p>The final photos for the superhero are:</p>
<img src="/blog/2024-01-16-dani-kusbaro1.webp" alt="Coriander Man Fixed" width="300" />
<img src="/blog/2024-01-16-dani-kusbaro2.webp" alt="Coriander Man Fixed" width="300" />
<h2 id="face-swap-open-source-offline">Face Swap - Open-source (Offline)</h2>
<p>Any library / github project which is wrapping up Insightface is a good option.</p>
<p>I've personally used the <a href="https://github.com/KiranPranay/swapseed">swapseed</a> to do the replacement on my computer.</p>
<p>This is a sample code to run after installing the dependencies <code>pip install -r requirements.txt</code></p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#b48ead;">import </span><span>os
</span><span style="color:#b48ead;">import </span><span>matplotlib.pyplot </span><span style="color:#b48ead;">as </span><span>plt
</span><span style="color:#b48ead;">import </span><span>gdown
</span><span style="color:#b48ead;">import </span><span>insightface
</span><span style="color:#b48ead;">from </span><span>insightface.app </span><span style="color:#b48ead;">import </span><span>FaceAnalysis
</span><span style="color:#b48ead;">from </span><span>insightface.data </span><span style="color:#b48ead;">import </span><span>get_image </span><span style="color:#b48ead;">as </span><span>ins_get_image
</span><span style="color:#b48ead;">from </span><span>faceswap </span><span style="color:#b48ead;">import </span><span>swap_n_show, swap_n_show_same_img, swap_face_single,fine_face_swap
</span><span>
</span><span>app = </span><span style="color:#bf616a;">FaceAnalysis</span><span>(</span><span style="color:#bf616a;">name</span><span>=&#39;</span><span style="color:#a3be8c;">buffalo_l</span><span>&#39;)
</span><span>app.</span><span style="color:#bf616a;">prepare</span><span>(</span><span style="color:#bf616a;">ctx_id</span><span>=</span><span style="color:#d08770;">0</span><span>, </span><span style="color:#bf616a;">det_size</span><span>=(</span><span style="color:#d08770;">640</span><span>, </span><span style="color:#d08770;">640</span><span>))
</span><span>
</span><span style="color:#65737e;"># Download &#39;inswapper_128.onnx&#39; file using gdown
</span><span>model_url = &#39;</span><span style="color:#a3be8c;">https://drive.google.com/uc?id=1HvZ4MAtzlY74Dk4ASGIS9L6Rg5oZdqvu</span><span>&#39;
</span><span>model_output_path = &#39;</span><span style="color:#a3be8c;">inswapper/inswapper_128.onnx</span><span>&#39;
</span><span style="color:#b48ead;">if </span><span>not os.path.</span><span style="color:#bf616a;">exists</span><span>(model_output_path):
</span><span>    gdown.</span><span style="color:#bf616a;">download</span><span>(model_url, model_output_path, </span><span style="color:#bf616a;">quiet</span><span>=</span><span style="color:#d08770;">False</span><span>)
</span><span>
</span><span>swapper = insightface.model_zoo.</span><span style="color:#bf616a;">get_model</span><span>(&#39;</span><span style="color:#a3be8c;">inswapper/inswapper_128.onnx</span><span>&#39;, </span><span style="color:#bf616a;">download</span><span>=</span><span style="color:#d08770;">False</span><span>, </span><span style="color:#bf616a;">download_zip</span><span>=</span><span style="color:#d08770;">False</span><span>)
</span><span>
</span><span style="color:#65737e;"># Load images
</span><span>img1_fn = &#39;</span><span style="color:#a3be8c;">input_and_output.png</span><span>&#39;
</span><span>img2_fn = &#39;</span><span style="color:#a3be8c;">face_to_replace_from.jpg</span><span>&#39;
</span><span>
</span><span style="color:#65737e;"># Swap faces between two images
</span><span style="color:#65737e;"># swap_n_show(img1_fn, img2_fn, app, swapper)
</span><span>
</span><span style="color:#65737e;"># Add face to an image
</span><span style="color:#bf616a;">swap_face_single</span><span>(img1_fn, img2_fn, app, swapper, </span><span style="color:#bf616a;">enhance</span><span>=</span><span style="color:#d08770;">True</span><span>, </span><span style="color:#bf616a;">enhancer</span><span>=&#39;</span><span style="color:#a3be8c;">REAL-ESRGAN 2x</span><span>&#39;)
</span></code></pre>

  </div>

  <hr class="footer-rule" />

  

  <div class="related-container">

    

    

  </div>


    </main>
    <footer class="footer-page">
    
      
    
    </footer>
  </body>
</html>
